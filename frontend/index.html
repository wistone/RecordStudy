<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â≠¶‰π†Êê≠Â≠ê - ËÆ∞ÂΩïÊØè‰∏ÄÊ≠•ÊàêÈïø</title>
    <link rel="stylesheet" href="styles/main.css?v=20250825-5">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <svg class="logo" viewBox="0 0 40 40" width="32" height="32">
                        <rect x="8" y="8" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"/>
                        <circle cx="20" cy="20" r="6" fill="currentColor" opacity="0.8"/>
                    </svg>
                    <span>Â≠¶‰π†Êê≠Â≠ê</span>
                </div>
                <div class="nav-links">
                    <a href="#/" class="nav-link active">È¶ñÈ°µ</a>
                    <a href="#/analytics" class="nav-link">Êï∞ÊçÆÂàÜÊûê</a>
                    <a href="#/records" class="nav-link">Â≠¶‰π†ËÆ∞ÂΩï</a>
                </div>
                <div class="nav-user">
                    <div class="streak-badge">
                        <span class="streak-icon">üî•</span>
                        <span id="streakDays">0</span>Â§©
                    </div>
                    <div class="user-profile" onclick="toggleUserMenu()">
                        <div class="user-avatar">
                            <span class="avatar-icon">üë§</span>
                        </div>
                        <span class="user-name">Â≠¶‰π†ËÄÖ</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="dropdown-arrow">
                            <polyline points="6,9 12,15 18,9"></polyline>
                        </svg>
                    </div>
                    
                    <!-- User Menu Dropdown -->
                    <div id="userMenu" class="user-menu">
                        <div class="user-menu-header">
                            <div class="user-menu-avatar">
                                <span class="avatar-icon">üë§</span>
                            </div>
                            <div class="user-menu-info">
                                <div class="user-menu-name">Â≠¶‰π†ËÄÖ</div>
                                <div class="user-menu-email">demo@example.com</div>
                            </div>
                        </div>
                        <div class="user-menu-divider"></div>
                        <div class="user-menu-items">
                            <a href="#" class="user-menu-item" onclick="showProfile()">
                                <span class="menu-icon">üë§</span>
                                ‰∏™‰∫∫ËµÑÊñô
                            </a>
                            <a href="#" class="user-menu-item" onclick="showSettings()">
                                <span class="menu-icon">‚öôÔ∏è</span>
                                ËÆæÁΩÆ
                            </a>
                            <div class="user-menu-divider"></div>
                            <a href="#" class="user-menu-item logout" onclick="handleLogout()">
                                <span class="menu-icon">üö™</span>
                                ÈÄÄÂá∫ÁôªÂΩï
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main id="mainContent">
            <!-- Home Page -->
            <div id="homePage" class="page active">
                <div class="container">
                    <!-- Hero Section -->
                    <section class="hero">
                        <h1 class="hero-title">ËÆ∞ÂΩïÂ≠¶‰π†ÔºåËßÅËØÅÊàêÈïø</h1>
                        <p class="hero-subtitle">ÈöèÊâãËÆ∞ÂΩïÊØèÂ§©ÁöÑÂ≠¶‰π†ÂÜÖÂÆπ„ÄÅËøõÂ∫¶‰∏éÊÄùËÄÉ</p>
                        <div class="hero-actions">
                            <button class="btn btn-primary btn-large" onclick="app.showQuickRecord()">
                                <span class="btn-icon">üìù</span>
                                ÂºÄÂßãËÆ∞ÂΩï
                            </button>
                        </div>
                    </section>

                    <!-- Learning Summary -->
                    <section class="learning-summary">
                        <h2 class="section-title">Â≠¶‰π†Ê¶ÇËßà</h2>
                        <div class="summary-cards">
                            <div class="summary-card today">
                                <div class="card-header">
                                    <div class="card-icon">üìÖ</div>
                                    <div class="card-period">‰ªäÊó•</div>
                                </div>
                                <div class="card-metrics">
                                    <div class="metric">
                                        <div class="metric-value" id="todayDuration">0</div>
                                        <div class="metric-label">ÂàÜÈíü</div>
                                    </div>
                                    <div class="metric">
                                        <div class="metric-value" id="todayRecords">0</div>
                                        <div class="metric-label">ËÆ∞ÂΩï</div>
                                    </div>
                                </div>
                            </div>
                            <div class="summary-card week">
                                <div class="card-header">
                                    <div class="card-icon">üìä</div>
                                    <div class="card-period">Êú¨Âë®</div>
                                </div>
                                <div class="card-metrics">
                                    <div class="metric">
                                        <div class="metric-value" id="weekDuration">0</div>
                                        <div class="metric-label">Â∞èÊó∂</div>
                                    </div>
                                    <div class="metric">
                                        <div class="metric-value" id="weekDays">0</div>
                                        <div class="metric-label">Ê¥ªË∑ÉÂ§©Êï∞</div>
                                    </div>
                                </div>
                            </div>
                            <div class="summary-card month">
                                <div class="card-header">
                                    <div class="card-icon">üéØ</div>
                                    <div class="card-period">Êú¨Êúà</div>
                                </div>
                                <div class="card-metrics">
                                    <div class="metric">
                                        <div class="metric-value" id="monthDuration">0</div>
                                        <div class="metric-label">Â∞èÊó∂</div>
                                    </div>
                                    <div class="metric">
                                        <div class="metric-value" id="monthStreak">0</div>
                                        <div class="metric-label">ËøûÁª≠Â§©Êï∞</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Recent Records -->
                    <section class="recent-records">
                        <div class="section-header">
                            <h2 class="section-title">ÊúÄËøëËÆ∞ÂΩï</h2>
                            <a href="#/records" class="link-more">Êü•ÁúãÂÖ®ÈÉ® ‚Üí</a>
                        </div>
                        <div id="recentRecordsList" class="records-list">
                            <!-- Records will be inserted here -->
                        </div>
                    </section>
                </div>
            </div>

            <!-- Records Page -->
            <div id="recordsPage" class="page">
                <div class="container">
                    <div class="page-header">
                        <h1>Â≠¶‰π†ËÆ∞ÂΩï</h1>
                        <button class="btn btn-primary" onclick="app.showQuickRecord()">Êñ∞Âª∫ËÆ∞ÂΩï</button>
                    </div>
                    
                    <!-- Filters -->
                    <div class="filters">
                        <select class="filter-select" id="typeFilter">
                            <option value="">ÊâÄÊúâÁ±ªÂûã</option>
                            <option value="video">ËßÜÈ¢ë</option>
                            <option value="podcast">Êí≠ÂÆ¢</option>
                            <option value="book">‰π¶Á±ç</option>
                            <option value="course">ËØæÁ®ã</option>
                            <option value="article">ÊñáÁ´†</option>
                            <option value="exercise">È¢òÁõÆ</option>
                            <option value="project">È°πÁõÆ</option>
                            <option value="workout">ËøêÂä®</option>
                            <option value="other">ÂÖ∂‰ªñ</option>
                        </select>
                        <input type="text" class="filter-input" id="searchInput" placeholder="ÊêúÁ¥¢Ê†áÈ¢òÊàñÂÜÖÂÆπ...">
                    </div>

                    <!-- Records List -->
                    <div id="recordsList" class="records-list full">
                        <!-- Records will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Record Detail Page -->
            <div id="recordDetailPage" class="page" style="display: none;">
                <div class="container">
                    <!-- Breadcrumb Navigation -->
                    <div class="breadcrumb">
                        <span class="breadcrumb-link" onclick="app.showPage('records')">Â≠¶‰π†ËÆ∞ÂΩï</span>
                        <span class="breadcrumb-separator">‚Ä∫</span>
                        <span class="breadcrumb-current">ËÆ∞ÂΩïËØ¶ÊÉÖ</span>
                    </div>
                    
                    <!-- Page Header -->
                    <div class="page-header">
                        <h1 id="recordDetailTitle">ËÆ∞ÂΩïËØ¶ÊÉÖ</h1>
                        <div class="page-actions">
                            <!-- ÊåâÈ°∫Â∫èÊéíÂàóÔºöÁºñËæë ‚Üí ËøîÂõûÂàóË°® ‚Üí Âà†Èô§ËÆ∞ÂΩï -->
                            <button class="btn btn-secondary" onclick="app.toggleEditMode()" id="editModeBtn">ÁºñËæë</button>
                            <button class="btn btn-secondary" onclick="app.cancelEdit()" id="cancelEditBtn" style="display: none;">ÂèñÊ∂à</button>
                            <button class="btn btn-success" onclick="app.saveRecordDetail()" id="saveDetailBtn" style="display: none;">‰øùÂ≠ò‰øÆÊîπ</button>
                            <button class="btn btn-secondary" onclick="app.showPage('records')">ËøîÂõûÂàóË°®</button>
                            <button class="btn-delete-confirm" onclick="app.confirmDeleteRecord(app.currentRecordId)" id="deleteRecordBtn">Âà†Èô§ËÆ∞ÂΩï</button>
                        </div>
                    </div>
                    
                    <!-- Record Detail Content - 3 Column Layout -->
                    <div class="record-detail-layout three-column">
                        <!-- Left Column: Âü∫Á°Ä‰ø°ÊÅØ + Êó∂Èïø‰ø°ÊÅØ + Â≠¶‰π†‰ΩìÈ™å -->
                        <div class="record-detail-left">
                            <div class="detail-section">
                                <h3>Âü∫Á°Ä‰ø°ÊÅØ</h3>
                                <div class="detail-fields">
                                    <div class="detail-field">
                                        <label>ËÆ∞ÂΩïÊ†áÈ¢ò</label>
                                        <input type="text" id="recordDetailTitleField" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>Â≠¶‰π†ÂΩ¢Âºè</label>
                                        <select id="recordDetailFormType" class="detail-select" disabled>
                                            <option value="video">üìπ ËßÜÈ¢ë</option>
                                            <option value="podcast">üéôÔ∏è Êí≠ÂÆ¢</option>
                                            <option value="book">üìö ‰π¶Á±ç</option>
                                            <option value="course">üéì ËØæÁ®ã</option>
                                            <option value="article">üìÑ ÊñáÁ´†</option>
                                            <option value="exercise">‚úèÔ∏è È¢òÁõÆ</option>
                                            <option value="project">üíª È°πÁõÆ</option>
                                            <option value="workout">üèÉ ËøêÂä®</option>
                                            <option value="other">üìå ÂÖ∂‰ªñ</option>
                                        </select>
                                    </div>
                                    <div class="detail-field">
                                        <label>ÂèëÁîüÊó∂Èó¥</label>
                                        <input type="datetime-local" id="recordDetailOccurredAt" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>ÊÄªÊó∂Èïø (ÂàÜÈíü)</label>
                                        <input type="number" id="recordDetailDuration" class="detail-input" readonly>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-section">
                                <h3>Â≠¶‰π†‰ΩìÈ™å</h3>
                                <div class="detail-fields">
                                    <div class="detail-field">
                                        <label>ÈöæÂ∫¶ËØÑÁ∫ß</label>
                                        <div class="rating-display" id="recordDetailDifficulty">
                                            <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                                        </div>
                                    </div>
                                    <div class="detail-field">
                                        <label>‰∏ìÊ≥®Â∫¶</label>
                                        <div class="rating-display" id="recordDetailFocus">
                                            <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                                        </div>
                                    </div>
                                    <div class="detail-field">
                                        <label>Á≤æÂäõÁä∂ÊÄÅ</label>
                                        <div class="rating-display" id="recordDetailEnergy">
                                            <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                                        </div>
                                    </div>
                                    <div class="detail-field">
                                        <label>ÂøÉÊÉÖËÆ∞ÂΩï</label>
                                        <textarea id="recordDetailMood" class="detail-textarea" readonly></textarea>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                        <!-- Middle Column: Â≠¶‰π†Á¨îËÆ∞ -->
                        <div class="record-detail-middle">
                            <div class="detail-section">
                                <h3>Â≠¶‰π†Á¨îËÆ∞</h3>
                                <div class="detail-fields">
                                    <textarea id="recordDetailBodyMd" class="detail-textarea large" readonly placeholder="Â≠¶‰π†Á¨îËÆ∞ÂíåËØ¶ÁªÜÂÜÖÂÆπ..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right Column: Ê†áÁ≠æÁÆ°ÁêÜ + ÂÖ≥ËÅîËµÑÊ∫ê -->
                        <div class="record-detail-right">
                            <div class="detail-section">
                                <h3>Ê†áÁ≠æÁÆ°ÁêÜ</h3>
                                <div class="tags-display" id="recordDetailTags">
                                    <!-- Tags will be displayed here -->
                                </div>
                                <div class="tag-editor" id="tagEditor" style="display: none;">
                                    <input type="text" id="newTagInput" class="tag-input" placeholder="ËæìÂÖ•Êñ∞Ê†áÁ≠æ...">
                                    <button class="btn-small btn-primary" onclick="app.addTagToRecord()">Ê∑ªÂä†</button>
                                </div>
                            </div>
                            
                            <div class="detail-section" id="resourceSection">
                                <h3>ÂÖ≥ËÅîËµÑÊ∫ê</h3>
                                <div class="detail-fields" id="resourceFields">
                                    <div class="detail-field">
                                        <label>ËµÑÊ∫êÊ†áÈ¢ò</label>
                                        <input type="text" id="resourceDetailTitle" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>ËµÑÊ∫êÁ±ªÂûã</label>
                                        <select id="resourceDetailType" class="detail-select" disabled>
                                            <option value="video">ËßÜÈ¢ë</option>
                                            <option value="podcast">Êí≠ÂÆ¢</option>
                                            <option value="book">‰π¶Á±ç</option>
                                            <option value="course">ËØæÁ®ã</option>
                                            <option value="article">ÊñáÁ´†</option>
                                            <option value="paper">ËÆ∫Êñá</option>
                                            <option value="exercise">ÁªÉ‰π†</option>
                                            <option value="project">È°πÁõÆ</option>
                                            <option value="workout">ËøêÂä®</option>
                                            <option value="other">ÂÖ∂‰ªñ</option>
                                        </select>
                                    </div>
                                    <div class="detail-field">
                                        <label>‰ΩúËÄÖ‰ø°ÊÅØ</label>
                                        <input type="text" id="resourceDetailAuthor" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>ËµÑÊ∫êÈìæÊé•</label>
                                        <input type="url" id="resourceDetailUrl" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>Âπ≥Âè∞‰ø°ÊÅØ</label>
                                        <input type="text" id="resourceDetailPlatform" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>ISBN (‰ªÖ‰π¶Á±ç)</label>
                                        <input type="text" id="resourceDetailIsbn" class="detail-input" readonly>
                                    </div>
                                    <div class="detail-field">
                                        <label>ËµÑÊ∫êÊèèËø∞</label>
                                        <textarea id="resourceDetailDescription" class="detail-textarea" readonly></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-section" id="userResourceSection" style="display: none;">
                                <h3>‰∏™‰∫∫ËµÑÊ∫êÂÖ≥Á≥ª</h3>
                                <div class="detail-fields">
                                    <div class="detail-field">
                                        <label>ËµÑÊ∫êÁä∂ÊÄÅ</label>
                                        <select id="userResourceStatus" class="detail-select" disabled>
                                            <option value="wishlist">ÂæÖÂ≠¶‰π†</option>
                                            <option value="learning">Â≠¶‰π†‰∏≠</option>
                                            <option value="paused">Â∑≤ÊöÇÂÅú</option>
                                            <option value="done">Â∑≤ÂÆåÊàê</option>
                                            <option value="reviewing">Â§ç‰π†‰∏≠</option>
                                        </select>
                                    </div>
                                    <div class="detail-field">
                                        <label>‰∏™‰∫∫ËØÑÂàÜ</label>
                                        <div class="rating-display" id="userResourceRating">
                                            <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                                        </div>
                                    </div>
                                    <div class="detail-field">
                                        <label>ÁÆÄÁü≠ËØÑ‰ª∑</label>
                                        <textarea id="userResourceReview" class="detail-textarea" readonly></textarea>
                                    </div>
                                    <div class="detail-field">
                                        <label>Êî∂ËóèÁä∂ÊÄÅ</label>
                                        <div class="favorite-toggle">
                                            <input type="checkbox" id="userResourceFavorite" disabled>
                                            <label for="userResourceFavorite">Êî∂ËóèÊ≠§ËµÑÊ∫ê</label>
                                        </div>
                                    </div>
                                    <div class="detail-field">
                                        <label>Á¥ØËÆ°Â≠¶‰π†Êó∂Èïø</label>
                                        <div class="readonly-field" id="userResourceTotalDuration">0 ÂàÜÈíü</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-section" id="assetsSection" style="display: none;">
                                <h3>ÈôÑ‰ª∂ËµÑÊ∫ê</h3>
                                <div class="assets-display" id="recordDetailAssets">
                                    <!-- Assets will be displayed here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Page -->
            <div id="analyticsPage" class="page">
                <div class="container">
                    <h1 class="page-title">Êï∞ÊçÆÂàÜÊûê</h1>
                    
                    <!-- Time Stats and Calendar Row -->
                    <section class="stats-row">
                        <!-- Time Stats -->
                        <div class="time-stats-container">
                            <div class="section-header">
                                <h2 class="section-title">Â≠¶‰π†Êó∂ÈïøË∂ãÂäø</h2>
                                <div class="period-tabs">
                                    <button class="period-tab active" data-period="week" onclick="app.switchPeriod('week')">Âë®</button>
                                    <button class="period-tab" data-period="month" onclick="app.switchPeriod('month')">Êúà</button>
                                    <button class="period-tab" data-period="year" onclick="app.switchPeriod('year')">Âπ¥</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <div id="durationChart" class="chart-placeholder">
                                    <div class="chart-bars" id="chartBars">
                                        <!-- Chart bars will be generated here -->
                                    </div>
                                    <div class="chart-labels" id="chartLabels">
                                        <!-- Chart labels will be generated here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Calendar Widget -->
                        <div class="calendar-widget">
                            <div class="widget-header">
                                <h3>ÊâìÂç°Êó•ÂéÜ</h3>
                                <div class="calendar-nav-mini">
                                    <button class="nav-btn" onclick="app.changeMonth(-1)">‚Äπ</button>
                                    <span id="miniCalendarMonth">2024Âπ¥1Êúà</span>
                                    <button class="nav-btn" onclick="app.changeMonth(1)">‚Ä∫</button>
                                </div>
                            </div>
                            <div id="miniCalendarGrid" class="mini-calendar-grid">
                                <!-- Mini calendar will be generated here -->
                            </div>
                        </div>
                    </section>

                    <!-- Category Stats -->
                    <section class="stats-section">
                        <h2 class="section-title">Â≠¶‰π†ÂàÜÊûê</h2>
                        <div class="stats-grid-three">
                            <div class="stat-card">
                                <h3>Â≠¶‰π†ÂΩ¢ÂºèÂàÜÂ∏É</h3>
                                <div id="typeStats" class="stat-list">
                                    <!-- Stats will be inserted here -->
                                </div>
                            </div>
                            <div class="stat-card">
                                <h3>ÁÉ≠Èó®‰∏ªÈ¢ò</h3>
                                <div id="weeklyTopics" class="stat-list">
                                    <!-- Stats will be inserted here -->
                                </div>
                            </div>
                            <div class="stat-card">
                                <h3>ÈáåÁ®ãÁ¢ëÊàêÂ∞±</h3>
                                <div class="milestone-mini-list">
                                    <div class="milestone-mini-item">
                                        <div class="milestone-mini-icon">üéØ</div>
                                        <div class="milestone-mini-content">
                                            <span class="milestone-mini-title">Á¥ØËÆ°100Â∞èÊó∂</span>
                                            <span class="milestone-mini-date">2024-01-20</span>
                                        </div>
                                    </div>
                                    <div class="milestone-mini-item">
                                        <div class="milestone-mini-icon">üìö</div>
                                        <div class="milestone-mini-content">
                                            <span class="milestone-mini-title">ËøûÁª≠Â≠¶‰π†21Â§©</span>
                                            <span class="milestone-mini-date">2024-01-18</span>
                                        </div>
                                    </div>
                                    <div class="milestone-mini-item">
                                        <div class="milestone-mini-icon">üèÜ</div>
                                        <div class="milestone-mini-content">
                                            <span class="milestone-mini-title">ÂÆåÊàê5‰∏™È°πÁõÆ</span>
                                            <span class="milestone-mini-date">2024-01-15</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- AI Summary -->
                    <section class="ai-summary">
                        <h2 class="section-title">AI Êô∫ËÉΩÊÄªÁªì</h2>
                        <div class="summary-content">
                            <div class="summary-insights">
                                <div class="insight-item">
                                    <div class="insight-icon">üìà</div>
                                    <div class="insight-text">
                                        <strong>Â≠¶‰π†Ë∂ãÂäøÔºö</strong>
                                        <span id="trendInsight">Êú¨ÊúàÂ≠¶‰π†Êó∂ÈïøÁõ∏ÊØî‰∏äÊúàÂ¢ûÈïø25%Ôºå‰øùÊåÅËâØÂ•Ω‰∏äÂçáË∂ãÂäø</span>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon">üéØ</div>
                                    <div class="insight-text">
                                        <strong>ÈáçÁÇπÊñπÂêëÔºö</strong>
                                        <span id="focusInsight">AIÂíåÁºñÁ®ãÊòØ‰Ω†ÁöÑ‰∏ªË¶ÅÂ≠¶‰π†ÊñπÂêëÔºåÂç†ÊÄªÊó∂ÈïøÁöÑ65%</span>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon">‚≠ê</div>
                                    <div class="insight-text">
                                        <strong>‰ºòÂäøË°®Áé∞Ôºö</strong>
                                        <span id="strengthInsight">ËßÜÈ¢ëÂ≠¶‰π†ÊïàÁéáÊúÄÈ´òÔºåÂπ≥Âùá‰∏ìÊ≥®Â∫¶ËææÂà∞4.5/5</span>
                                    </div>
                                </div>
                            </div>
                            <div class="next-action">
                                <div class="action-header">
                                    <strong>üöÄ ‰∏ã‰∏ÄÊ≠•Ë°åÂä®Âª∫ËÆÆ</strong>
                                </div>
                                <div class="action-content">
                                    <span id="nextActionText">Âª∫ËÆÆÁªßÁª≠Âä†Âº∫ÂÆûË∑µÈ°πÁõÆÔºåÂèØ‰ª•Â∞ùËØïÂ∞ÜÁêÜËÆ∫Áü•ËØÜÂ∫îÁî®Âà∞ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÔºåÊèêÈ´òÂ≠¶‰π†ËΩ¨ÂåñÁéá</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

        </main>

        <!-- Quick Record Modal -->
        <div id="quickRecordModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Âø´ÈÄüËÆ∞ÂΩï</h2>
                    <button class="modal-close" onclick="app.closeQuickRecord()">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- Tab Navigation -->
                    <div class="tabs">
                        <button class="tab-btn active" onclick="app.switchRecordTab('form')">Ë°®ÂçïËÆ∞ÂΩï</button>
                        <button class="tab-btn" onclick="app.switchRecordTab('quick')">ÈöèÊâãËÆ∞</button>
                    </div>

                    <!-- Form Record -->
                    <div id="formRecord" class="tab-content active">
                        <form id="recordForm" class="record-form">
                            <!-- Step 1: Title -->
                            <div class="form-step active" data-step="1">
                                <label class="form-label">Ê†áÈ¢ò</label>
                                <input type="text" class="form-input" id="recordTitle" placeholder="ËæìÂÖ•Â≠¶‰π†ÂÜÖÂÆπÊ†áÈ¢ò..." required>
                            </div>

                            <!-- Step 2: Type -->
                            <div class="form-step" data-step="2">
                                <label class="form-label">ÈÄâÊã©ÂΩ¢ÂºèÁ±ªÂà´</label>
                                <div class="type-grid">
                                    <button type="button" class="type-btn" data-type="video">üìπ ËßÜÈ¢ë</button>
                                    <button type="button" class="type-btn" data-type="podcast">üéôÔ∏è Êí≠ÂÆ¢</button>
                                    <button type="button" class="type-btn" data-type="book">üìö ‰π¶Á±ç</button>
                                    <button type="button" class="type-btn" data-type="course">üéì ËØæÁ®ã</button>
                                    <button type="button" class="type-btn" data-type="article">üìÑ ÊñáÁ´†</button>
                                    <button type="button" class="type-btn" data-type="exercise">‚úèÔ∏è È¢òÁõÆ</button>
                                    <button type="button" class="type-btn" data-type="project">üíª È°πÁõÆ</button>
                                    <button type="button" class="type-btn" data-type="workout">üèÉ ËøêÂä®</button>
                                    <button type="button" class="type-btn" data-type="other">üìå ÂÖ∂‰ªñ</button>
                                </div>
                            </div>

                            <!-- Step 3: Categories -->
                            <div class="form-step" data-step="3">
                                <label class="form-label">ÂÜÖÂÆπÊ†áÁ≠æÔºàÂèØÂ§öÈÄâÔºâ</label>
                                <div class="tag-input-container">
                                    <input type="text" class="tag-input" id="tagInput" placeholder="ËæìÂÖ•Ê†áÁ≠æÔºåÂ¶ÇÔºöËã±ËØ≠„ÄÅÁºñÁ®ã„ÄÅAI...">
                                    <div class="tag-suggestions">
                                        <span class="tag-suggestion">Ëã±ËØ≠</span>
                                        <span class="tag-suggestion">AI</span>
                                        <span class="tag-suggestion">Êï∞Â≠¶</span>
                                        <span class="tag-suggestion">ÁºñÁ®ã</span>
                                        <span class="tag-suggestion">ÂéÜÂè≤</span>
                                    </div>
                                </div>
                                <div class="selected-tags" id="selectedTags"></div>
                            </div>

                            <!-- Step 4: Duration -->
                            <div class="form-step" data-step="4">
                                <label class="form-label">Â≠¶‰π†Êó∂ÈïøÔºàÂàÜÈíüÔºâ</label>
                                <input type="number" class="form-input" id="recordDuration" placeholder="25" min="1">
                                <div class="duration-presets">
                                    <button type="button" class="preset-btn" data-duration="25">25ÂàÜÈíü</button>
                                    <button type="button" class="preset-btn" data-duration="45">45ÂàÜÈíü</button>
                                    <button type="button" class="preset-btn" data-duration="60">1Â∞èÊó∂</button>
                                    <button type="button" class="preset-btn" data-duration="90">1.5Â∞èÊó∂</button>
                                </div>
                            </div>

                            <!-- Step 5: Feedback -->
                            <div class="form-step" data-step="5">
                                <label class="form-label">ÂèçÈ¶àÔºàÂèØÈÄâÔºâ</label>
                                <div class="feedback-grid">
                                    <div class="feedback-item">
                                        <label>ÈöæÂ∫¶</label>
                                        <div class="rating" data-field="difficulty">
                                            <span class="star" data-value="1">‚òÜ</span>
                                            <span class="star" data-value="2">‚òÜ</span>
                                            <span class="star" data-value="3">‚òÜ</span>
                                            <span class="star" data-value="4">‚òÜ</span>
                                            <span class="star" data-value="5">‚òÜ</span>
                                        </div>
                                    </div>
                                    <div class="feedback-item">
                                        <label>‰∏ìÊ≥®Â∫¶</label>
                                        <div class="rating" data-field="focus">
                                            <span class="star" data-value="1">‚òÜ</span>
                                            <span class="star" data-value="2">‚òÜ</span>
                                            <span class="star" data-value="3">‚òÜ</span>
                                            <span class="star" data-value="4">‚òÜ</span>
                                            <span class="star" data-value="5">‚òÜ</span>
                                        </div>
                                    </div>
                                </div>
                                <textarea class="form-textarea" id="recordMood" placeholder="ËÆ∞ÂΩï‰Ω†ÁöÑÊÄùËÄÉÂíåÊÑüÂèó..."></textarea>
                            </div>

                            <!-- Form Navigation -->
                            <div class="form-nav">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-secondary" onclick="app.prevStep()">‰∏ä‰∏ÄÊ≠•</button>
                                    <button type="button" class="btn btn-primary" onclick="app.nextStep()">‰∏ã‰∏ÄÊ≠•</button>
                                    <button type="submit" class="btn btn-success" style="display:none;">ÂÆåÊàêËÆ∞ÂΩï</button>
                                </div>
                                
                                <!-- Detailed Record Link -->
                                <div class="detailed-record-link">
                                    <a href="javascript:void(0)" onclick="app.createNewDetailedRecord()">
                                        ÈúÄË¶ÅÂ°´ÂÜôÊõ¥Â§ö‰ø°ÊÅØÔºüÂâçÂæÄËØ¶ÁªÜËÆ∞ÂΩï ‚Üí
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Quick Note -->
                    <div id="quickNote" class="tab-content">
                        <div class="quick-note-form">
                            <textarea class="quick-input" placeholder="ËÆ∞ÂΩï‰∏ÄÂè•ËØù„ÄÅÁ≤òË¥¥ÈìæÊé•Êàñ‰∏ä‰º†ÂõæÁâá..." rows="4"></textarea>
                            <div class="quick-actions">
                                <button class="btn-icon-action" title="‰∏ä‰º†ÂõæÁâá">üì∑</button>
                                <button class="btn-icon-action" title="Ê∑ªÂä†ÈìæÊé•">üîó</button>
                            </div>
                            <button class="btn btn-primary btn-block" onclick="app.saveQuickNote()">Êô∫ËÉΩËØÜÂà´Âπ∂‰øùÂ≠ò</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Include Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Include Environment Variables -->
    <script src="js/env.js"></script>
    <!-- Include Cache Service (temporarily disabled) -->
    <!-- <script src="js/cache-service.js?v=20250827-1"></script> -->
    <!-- Include Authentication Service -->
    <script src="js/auth.js?v=20250825-6"></script>
    <!-- Include API Service -->
    <script src="js/api-service.js?v=20250827-nocache"></script>
    <!-- Include Main Application -->
    <script src="js/app.js?v=20250827-fixicons"></script>
    
    <script>
        let isRedirecting = false; // Èò≤Ê≠¢ÈáçÂ§çÈáçÂÆöÂêë

        // Authentication check and redirect logic
        document.addEventListener('DOMContentLoaded', () => {
            // Âª∂ËøüÊ£ÄÊü•ÔºåÁ°Æ‰øùËÆ§ËØÅÊúçÂä°ÂÆåÂÖ®ÂàùÂßãÂåñ
            setTimeout(() => {
                console.log('üîç Ê£ÄÊü•È¶ñÈ°µËÆ§ËØÅÁä∂ÊÄÅ:', authService.isAuthenticated());
                
                // Check authentication status
                if (!authService.isAuthenticated() && !isRedirecting) {
                    console.log('‚ùå Êú™ÁôªÂΩïÔºåÈáçÂÆöÂêëÂà∞ÁôªÂΩïÈ°µ');
                    isRedirecting = true;
                    window.location.href = 'login.html';
                    return;
                }
                
                // Â¶ÇÊûúÂ∑≤ÁôªÂΩïÔºåÊõ¥Êñ∞Áî®Êà∑ÊòæÁ§∫
                if (authService.isAuthenticated()) {
                    updateUserDisplay(authService.getCurrentUser());
                }
                
                // ÁõëÂê¨ËÆ§ËØÅÁä∂ÊÄÅÂèòÂåñ
                authService.onAuthStateChange((user) => {
                    console.log('üë§ È¶ñÈ°µËÆ§ËØÅÁä∂ÊÄÅÂèòÂåñ:', !!user);
                    if (!user && !isRedirecting) {
                        isRedirecting = true;
                        window.location.href = 'login.html';
                    } else if (user) {
                        updateUserDisplay(user);
                    }
                });
            }, 100);
        });

        // ÁõëÂê¨È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñÔºåÂΩì‰ªé‰∏™‰∫∫ËµÑÊñôÈ°µÈù¢ËøîÂõûÊó∂Âà∑Êñ∞Áî®Êà∑‰ø°ÊÅØ
        document.addEventListener('visibilitychange', async () => {
            if (!document.hidden && authService.isAuthenticated()) {
                console.log('üîÑ È°µÈù¢ÈáçÊñ∞ÂèØËßÅÔºåÂà∑Êñ∞Áî®Êà∑‰ø°ÊÅØ');
                await updateUserDisplay(authService.getCurrentUser());
            }
        });

        // ÁõëÂê¨localStorage‰∏≠ÁöÑÂ§¥ÂÉèÊõ¥Êñ∞‰∫ã‰ª∂
        window.addEventListener('storage', (event) => {
            if (event.key === 'avatarUpdated' && authService.isAuthenticated()) {
                console.log('üì∏ Ê£ÄÊµãÂà∞Â§¥ÂÉèÊõ¥Êñ∞‰∫ã‰ª∂');
                // Âª∂Ëøü‰∏ÄÁÇπÂÜçÂà∑Êñ∞ÔºåÁ°Æ‰øùÂ≠òÂÇ®Êìç‰ΩúÂÆåÊàê
                setTimeout(async () => {
                    await updateUserDisplay(authService.getCurrentUser());
                }, 100);
            }
        });

        // ÁõëÂê¨Êù•Ëá™‰∏™‰∫∫ËµÑÊñôÈ°µÈù¢ÁöÑÊ∂àÊÅØ
        window.addEventListener('message', (event) => {
            if (event.data.type === 'AVATAR_UPDATED' && authService.isAuthenticated()) {
                console.log('üì∏ Êî∂Âà∞Â§¥ÂÉèÊõ¥Êñ∞Ê∂àÊÅØ:', event.data.avatarUrl);
                setTimeout(async () => {
                    await updateUserDisplay(authService.getCurrentUser());
                }, 100);
            }
        });
        
        async function updateUserDisplay(user) {
            try {
                // Ëé∑ÂèñÂÆåÊï¥ÁöÑÁî®Êà∑ËµÑÊñô‰ø°ÊÅØ
                const profile = await window.apiService.request('/profiles/current', 'GET');
                
                if (profile && !profile.error) {
                    const displayName = profile.display_name || authService.getDisplayName();
                    const userEmail = profile.email || user?.email || 'demo@example.com';
                    const avatarUrl = profile.avatar_url;
                    
                    // Update main user name
                    const userNameElement = document.querySelector('.user-name');
                    if (userNameElement && displayName) {
                        userNameElement.textContent = displayName;
                    }
                    
                    // Update main user avatar
                    const userAvatarElement = document.querySelector('.user-avatar');
                    if (userAvatarElement) {
                        if (avatarUrl) {
                            userAvatarElement.innerHTML = `<img src="${avatarUrl}" alt="Â§¥ÂÉè" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">`;
                        } else {
                            userAvatarElement.innerHTML = '<span class="avatar-icon">üë§</span>';
                        }
                    }
                    
                    // Update dropdown menu info
                    const menuNameElement = document.querySelector('.user-menu-name');
                    const menuEmailElement = document.querySelector('.user-menu-email');
                    const menuAvatarElement = document.querySelector('.user-menu-avatar');
                    
                    if (menuNameElement && displayName) {
                        menuNameElement.textContent = displayName;
                    }
                    if (menuEmailElement && userEmail) {
                        menuEmailElement.textContent = userEmail;
                    }
                    if (menuAvatarElement) {
                        if (avatarUrl) {
                            menuAvatarElement.innerHTML = `<img src="${avatarUrl}" alt="Â§¥ÂÉè" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">`;
                        } else {
                            menuAvatarElement.innerHTML = '<span class="avatar-icon">üë§</span>';
                        }
                    }
                    
                    console.log('‚úÖ Áî®Êà∑ÊòæÁ§∫‰ø°ÊÅØÊõ¥Êñ∞ÊàêÂäü', { displayName, avatarUrl });
                } else {
                    // Â¶ÇÊûúËé∑ÂèñËµÑÊñôÂ§±Ë¥•Ôºå‰ΩøÁî®Âü∫Á°Ä‰ø°ÊÅØ
                    console.log('‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñÁî®Êà∑ËµÑÊñôÔºå‰ΩøÁî®Âü∫Á°Ä‰ø°ÊÅØ');
                    const displayName = authService.getDisplayName();
                    const userEmail = user?.email || 'demo@example.com';
                    
                    // Update main user name
                    const userNameElement = document.querySelector('.user-name');
                    if (userNameElement && displayName) {
                        userNameElement.textContent = displayName;
                    }
                    
                    // Update dropdown menu info
                    const menuNameElement = document.querySelector('.user-menu-name');
                    const menuEmailElement = document.querySelector('.user-menu-email');
                    if (menuNameElement && displayName) {
                        menuNameElement.textContent = displayName;
                    }
                    if (menuEmailElement && userEmail) {
                        menuEmailElement.textContent = userEmail;
                    }
                }
            } catch (error) {
                console.error('‚ùå Êõ¥Êñ∞Áî®Êà∑ÊòæÁ§∫‰ø°ÊÅØÂ§±Ë¥•:', error);
                // Âá∫ÈîôÊó∂‰ΩøÁî®Âü∫Á°Ä‰ø°ÊÅØ
                const displayName = authService.getDisplayName();
                const userEmail = user?.email || 'demo@example.com';
                
                const userNameElement = document.querySelector('.user-name');
                if (userNameElement && displayName) {
                    userNameElement.textContent = displayName;
                }
            }
        }
        
        // User menu functions
        function toggleUserMenu() {
            const userMenu = document.getElementById('userMenu');
            const userProfile = document.querySelector('.user-profile');
            
            userMenu.classList.toggle('show');
            userProfile.classList.toggle('open');
        }
        
        // Close menu when clicking outside
        document.addEventListener('click', (event) => {
            const userMenu = document.getElementById('userMenu');
            const userProfile = document.querySelector('.user-profile');
            
            if (!userProfile.contains(event.target)) {
                userMenu.classList.remove('show');
                userProfile.classList.remove('open');
            }
        });
        
        async function handleLogout() {
            if (confirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºü')) {
                try {
                    const { error } = await authService.signOut();
                    if (error) {
                        alert('ÈÄÄÂá∫ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                    } else {
                        // ÊàêÂäüÁôªÂá∫Ôºå‰ºöËá™Âä®Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢
                        window.location.href = 'login.html';
                    }
                } catch (error) {
                    alert('ÈÄÄÂá∫ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                }
            }
        }
        
        function showProfile() {
            console.log('üìç ÁÇπÂáª‰∏™‰∫∫ËµÑÊñôËèúÂçï');
            toggleUserMenu(); // Close the menu
            
            // Âª∂Ëøü‰∏ÄÁÇπÂÜçË∑≥ËΩ¨ÔºåÁ°Æ‰øùËèúÂçïÂÖ≥Èó≠Âä®Áîª‰∏ç‰ºöÂπ≤Êâ∞
            setTimeout(() => {
                console.log('üîÑ Ë∑≥ËΩ¨Âà∞‰∏™‰∫∫ËµÑÊñôÈ°µÈù¢');
                window.location.href = 'profile.html';
            }, 50);
        }
        
        function showSettings() {
            alert('ËÆæÁΩÆÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠...');
            toggleUserMenu(); // Close the menu
        }
    </script>
</body>
</html>